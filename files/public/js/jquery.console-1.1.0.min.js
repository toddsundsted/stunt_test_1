(function(a){a.fn.console=function(M){var E={37:q,39:x,38:aa,40:w,8:V,46:z,35:k,36:G,13:K,18:F};var P={65:G,69:k,68:z,78:w,80:aa,66:q,70:x,75:I};var l={70:W,66:H,68:p};var i='<span class="jquery-console-cursor">&nbsp;</span>';var J=a(this);var D=a('<div class="jquery-console-inner"></div>');var S=a('<textarea class="jquery-console-typer"></textarea>');var b;var Q;var g=M&&M.promptLabel?M.promptLabel:"> ";var ab=M&&M.continuedPromptLabel?M.continuedPromptLabel:"> ";var R=0;var n="";var N="";var h="";var o=[];var u=0;var O=0;var Z=true;var X=false;var U={};(function(){J.append(D);D.append(S);S.css({position:"absolute",top:0,left:"-9999px"});if(M.welcomeMessage){m(M.welcomeMessage,"jquery-console-welcome")}y();if(M.autofocus){D.addClass("jquery-console-focus");S.focus();setTimeout(function(){D.addClass("jquery-console-focus");S.focus()},100)}U.inner=D;U.typer=S;U.scrollToBottom=Y})();U.reset=function(){var ac=(typeof M.welcomeMessage!="undefined");D.parent().fadeOut(function(){D.find("div").each(function(){if(!ac){a(this).remove()}else{ac=false}});y();D.parent().fadeIn(function(){D.addClass("jquery-console-focus");S.focus()})})};U.notify=function(ag,ae){var ah=a('<div class="jquery-console-notice"></div>').append(a("<div></div>").text(ag)).css({visibility:"hidden"});J.append(ah);var af=true;if(ae=="fadeout"){setTimeout(function(){ah.fadeOut(function(){ah.remove()})},4000)}else{if(ae=="prompt"){var ac=a('<br/><div class="jquery-console-action"><a href="javascript:">OK</a><div class="jquery-console-clear"></div></div>');ah.append(ac);af=false;ac.click(function(){ah.fadeOut(function(){ah.remove();D.css({opacity:1})})})}}var ad=ah.height();ah.css({height:"0px",visibility:"visible"}).animate({height:ad+"px"},function(){if(!af){D.css({opacity:0.5})}});ah.css("cursor","default");return ah};U.append=function(ae,ad){var ac=D.children().last().remove();d(ae,ad);D.append(ac);Y()};function y(){R=0;n="";u=0;j();b=a('<div class="jquery-console-prompt-box"></div>');var ac=a('<span class="jquery-console-prompt-label"></span>');var ad=U.continuedPrompt?ab:g;b.append(ac.text(ad).show());ac.html(ac.html().replace(" ","&nbsp;"));Q=a('<span class="jquery-console-prompt"></span>');b.append(Q);D.append(b);f()}J.click(function(){D.addClass("jquery-console-focus");D.removeClass("jquery-console-nofocus");S.focus();Y();return false});S.blur(function(){D.removeClass("jquery-console-focus");D.addClass("jquery-console-nofocus")});S.bind("paste",function(ac){S.val("");setTimeout(function(){S.consoleInsert(S.val());S.val("")},0)});S.keydown(function(ad){O=0;var ac=ad.keyCode;if(ad.ctrlKey&&ac==67){O=ac;A();return false}if(Z){if(ac in E){O=ac;(E[ac])();return false}else{if(ad.ctrlKey&&ac in P){O=ac;(P[ac])();return false}else{if(ad.altKey&&ac in l){O=ac;(l[ac])();return false}}}}});S.keypress(function(ad){var ac=ad.keyCode||ad.which;if(s(ad)){return false}if((ad.ctrlKey||ad.metaKey)&&String.fromCharCode(ac).toLowerCase()=="v"){return true}if(Z&&O!=ac&&ac>=32){if(O){return false}if(typeof M.charInsertTrigger=="undefined"||(typeof M.charInsertTrigger=="function"&&M.charInsertTrigger(ac,n))){S.consoleInsert(ac)}}if(a.browser.webkit){return false}});function s(ac){return((ac.keyCode==E.tab||ac.keyCode==192)&&ac.altKey)}function c(ad){if(o.length==0){return}u+=ad;if(u<0){u=o.length}else{if(u>o.length){u=0}}var ac=n;if(u==0){n=N}else{n=o[u-1]}if(M.historyPreserveColumn){if(n.length<R+1){R=n.length}else{if(R==0){R=n.length}}}else{R=n.length}f()}function aa(){c(-1)}function w(){c(1)}function r(ac){o.push(ac);N=""}function B(){if(R<n.length){n=n.substring(0,R)+n.substring(R+1);N=n;return true}else{return false}}function V(){if(L(-1)){B();f()}}function z(){if(B()){f()}}function I(){while(B()){f()}}function p(){while(R<n.length&&!v(n[R])){B();f()}while(R<n.length&&v(n[R])){B();f()}}function K(){var ac=n;if(typeof M.commandValidate=="function"){var ad=M.commandValidate(ac);if(ad==true||ad==false){if(ad){e()}}else{C(ad,"jquery-console-message-error")}}else{e()}}function Y(){if(jQuery.fn.jquery>"1.6"){D.prop({scrollTop:D.prop("scrollHeight")})}else{D.attr({scrollTop:D.attr("scrollHeight")})}}function A(){if(typeof M.cancelHandle=="function"){M.cancelHandle()}}function e(){if(typeof M.commandHandle=="function"){T();r(n);var ad=n;if(U.continuedPrompt){if(h){h+="\n"+n}else{h=n}}else{h=undefined}if(h){ad=h}var ac=M.commandHandle(ad,function(ae){C(ae)});if(U.continuedPrompt&&!h){h=n}if(typeof ac=="boolean"){if(ac){C()}else{C("Command failed.","jquery-console-message-error")}}else{if(typeof ac=="string"){C(ac,"jquery-console-message-success")}else{if(typeof ac=="object"&&ac.length){C(ac)}else{if(U.continuedPrompt){C()}}}}}}function T(){Z=false}function j(){Z=true}function C(ad,ac){R=-1;f();d(ad,ac);y()}function d(af,ae){if(typeof af=="string"){m(af,ae)}else{if(a.isArray(af)){for(var ac in af){var ad=af[ac];m(ad.msg,ad.className)}}else{D.append(af)}}}function m(ae,ad){var ac=a('<div class="jquery-console-message"></div>');if(ad){ac.addClass(ad)}ac.filledText(ae).hide();D.append(ac);ac.show()}S.consoleInsert=function(ad){var af=isNaN(ad)?ad:String.fromCharCode(ad);var ac=n.substring(0,R);var ae=n.substring(R);n=ac+af+ae;L(af.length);N=n;f()};function L(ac){if(R+ac>=0&&R+ac<=n.length){R+=ac;return true}else{return false}}function x(){if(L(1)){f();return true}return false}function q(){if(L(-1)){f();return true}return false}function G(){if(L(-R)){f()}}function k(){if(L(n.length-R)){f()}}function W(){while(R<n.length&&!v(n[R])&&x()){}while(R<n.length&&v(n[R])&&x()){}}function H(){while(R-1>=0&&!v(n[R-1])&&q()){}while(R-1>=0&&v(n[R-1])&&q()){}}function v(ad){if(typeof ad=="string"){var ac=ad.charCodeAt();return(ac>="A".charCodeAt()&&ac<="Z".charCodeAt())||(ac>="a".charCodeAt()&&ac<="z".charCodeAt())||(ac>="0".charCodeAt()&&ac<="9".charCodeAt())}return false}function F(){}U.promptText=function(ac){if(ac){n=ac;R=n.length;f()}return n};function f(){var ac=n;var ad="";if(R>0&&ac==""){ad=i}else{if(R==n.length){ad=t(ac)+i}else{var ae=ac.substring(0,R);var af=ac.substring(R,R+1);if(af){af='<span class="jquery-console-cursor">'+t(af)+"</span>"}var ag=ac.substring(R+1);ad=t(ae)+af+t(ag)}}Q.html(ad);Y()}function t(ac){return(ac.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br />"))}return U};a.fn.filledText=function(b){a(this).text(b);a(this).html(a(this).html().replace(/\n/g,"<br/>"));return this}})(jQuery);